"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.testQuerySet = void 0;
const getSession = require('../database/getSession');
async function testQuerySet(querySet, databaseInfo) {
    const session = getSession.getSession(databaseInfo);
    for (let i = 0; i < querySet.length; i++) {
        const querySpec = querySet[i];
        const { query, params, output, name } = querySpec;
        let returnValue = [];
        // console.log(`running '${query}', params '${params}'`)
        try {
            await session.run(query, params).then((result) => {
                // console.log(`output from '${query}' is ${JSON.stringify(result)}`)
                returnValue = result;
            });
        }
        catch (error) {
            throw new Error(`error running query '${name ? name : query}': ${error}`);
        }
        if (JSON.stringify(returnValue.records) !== JSON.stringify(output.records)) {
            let queryName = name;
            if (!name)
                queryName = query;
            throw new Error(`query '${queryName}' is failing! returned this: ${JSON.stringify(returnValue)}`);
        }
    }
    return 'success';
}
exports.testQuerySet = testQuerySet;
